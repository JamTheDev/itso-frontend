<script lang="ts">
	import { enhance } from '$app/forms';
	import { CATEGORIES } from '$lib';

	let participantLimit: number;
	let isConsented: string;

	function getCategoryLimit(category: string): number {
		const value = CATEGORIES.get(category);

		if (!value || !value.limit) {
			return 0;
		}

		console.log(value.limit);

		return value.limit;
	}
</script>

<!-- <h1>Register</h1> -->

<h1 class="font-gt-walsheim-pro-medium text-5xl text-center">
	12th IT Skills Olympics Registration
</h1>

<form class="flex flex-col h-full" method="post" use:enhance>
	<div class="flex flex-col h-full w-full items-center">
		<div class="max-w-3xl p-4">
			<div>
				<div class="py-4">
					<h2 class="font-gt-walsheim-pro-medium text-2xl">Right to Privacy</h2>
				</div>
				<div class="py-4">
					<p>
						As provided by the Act, you may object to the processing of your personal data, request
						to access your personal information, and/or have it corrected, erased, or blocked on
						reasonable grounds. For the details of your rights as a data subject, you can get in
						touch with our Data Protection Officer at
						<span class="font-gt-walsheim-pro-medium text-amber-400"> dprms@umak.edu.ph </span>
						or at National Privacy Commission at
						<a
							href="https://privacy.gov.ph"
							class="font-gt-walsheim-pro-medium text-amber-400"
							rel="noreferrer"
							target="_blank"
						>
							https://privacy.gov.ph/
						</a>
						. For corrections or changes in the information you will submit, please contact
						<span class="font-gt-walsheim-pro-medium text-amber-400">
							itolympics.secretariat@gmail.com
						</span>
						. UMak-DPRMS & UMak-CCIS will consider your request and reserve the right to deal with the
						matter in accordance with the law
					</p>
				</div>
			</div>

			<div>
				<!-- <div class="py-4"> -->
				<!-- 	<span class="font-gt-walsheim-pro-medium">Consent</span> -->
				<!-- </div> -->
				<div class="py-4 space-y-4">
					<label class="flex gap-4">
						<input type="radio" name="consent" value="yes" bind:group={isConsented} />
						<p>
							Yes, I give my consent to UMak-CCIS to gather and process my personal information and
							document for this event.
						</p>
					</label>

					<label class="flex gap-4">
						<input type="radio" name="consent" value="no" bind:group={isConsented} />
						<p>
							No, I do not give my consent for UMak-CCIS to gather and process my personal
							information and documents for this event.
						</p>
					</label>
				</div>
			</div>

			{#if isConsented === 'yes'}
				<div class="py-4">
					<h2 class="font-gt-walsheim-pro-medium text-2xl">Registration Mechanics</h2>
				</div>
				<ol class="list-decimal pl-5">
					<li>
						<p>
							A
							<span class="text-amber-400 uppercase font-gt-walsheim-pro-medium">bona fide</span>
							student currently enrolled in the College or University he/she represents.
						</p>
					</li>
					<li>
						<p>Every participant MUST have an assigned COACH to completely represent the school.</p>
					</li>
					<li>
						<p>
							ONE participant for each event shall be allowed except Android Application
							Competition.
						</p>
					</li>

					<li>
						<p>
							The
							<span class="uppercase text-amber-400 font-gt-walsheim-pro-medium"
								>registration fee</span
							>
							is
							<span class="text-amber-400 font-gt-walsheim-pro-medium">Php 200.00</span>
							for each participant.
						</p>
					</li>
				</ol>
				<div class="flex flex-col py-4 gap-4">
					<label class="flex flex-col">
						<span class="font-gt-walsheim-pro-medium">Category</span>
						<select class="text-black p-2" name="category" bind:value={participantLimit}>
							{#each CATEGORIES as [key, value] (key)}
								<option value={value.limit}>{value.name}</option>
							{/each}
						</select>
					</label>

					<label class="flex flex-col">
						<span class="font-gt-walsheim-pro-medium">Name/s</span>
						<div class="flex flex-col gap-2">
							{#each Array(participantLimit) as _, idx (idx)}
								<div class="text-black flex gap-4">
									<input
										class="p-2 w-full"
										name={`first_name_${idx}`}
										type="text"
										placeholder="First"
										required
									/>
									<input
										class="p-2 w-full"
										name={`middle_name_${idx}`}
										type="text"
										placeholder="Middle"
										required
									/>
									<input
										class="p-2 w-full"
										name={`last_name_${idx}`}
										type="text"
										placeholder="Last"
										required
									/>
								</div>
							{/each}
						</div>
					</label>

					<label class="flex flex-col">
						<span class="font-gt-walsheim-pro-medium">School</span>
						<input
							class="p-2 text-black"
							name="school"
							type="text"
							placeholder="e.g. University of Makati"
							required
						/>
					</label>

					<label class="flex flex-col">
						<span class="font-gt-walsheim-pro-medium">Coach Name</span>
						<input
							class="p-2 text-black"
							name="coach_name"
							type="text"
							placeholder="e.g. Last, First"
							required
						/>
					</label>
				</div>

				<input type="number" name="participant_limit" value={participantLimit} hidden />

				<button class="flex bg-red-500 w-fit text-white p-2" type="submit">Submit</button>
			{/if}
		</div>
	</div>
</form>
